(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{362:function(t,s,e){"use strict";e.r(s);var a=e(14),n=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"cors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cors"}},[t._v("#")]),t._v(" CORS")]),t._v(" "),s("h2",{attrs:{id:"principle-analysis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#principle-analysis"}},[t._v("#")]),t._v(" Principle Analysis")]),t._v(" "),s("h3",{attrs:{id:"what-is-cors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#what-is-cors"}},[t._v("#")]),t._v(" What is CORS")]),t._v(" "),s("p",[t._v("CORS is a "),s("a",{attrs:{href:"https://www.w3.org/TR/2020/SPSD-cors-20200602/",target:"_blank",rel:"noopener noreferrer"}},[t._v("W3C standard mechanism"),s("OutboundLink")],1),t._v(' based on HTTP headers, with the full name of "Cross-Origin Resource Sharing". This mechanism uses additional HTTP response headers to inform the browser whether a page is allowed to access resources from servers with different origins, overcoming the limitation of AJAX which can only use the same origin, and enabling cross-origin access to resources.')]),t._v(" "),s("p",[t._v("For more information about CORS, please refer to the "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN document"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"same-origin-policy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#same-origin-policy"}},[t._v("#")]),t._v(" Same-Origin Policy")]),t._v(" "),s("p",[t._v("The Same-Origin Policy is an important security mechanism used to isolate potentially malicious files and reduce attacks. It limits how a page or script from one origin can interact with resources from another origin. For example, if a page uses AJAX to send a request to a URL from a different origin, the browser will detect that the request is from a different origin (i.e. cross-origin) and blocks the request, and then output the error message to the console.")]),t._v(" "),s("p",[t._v("So, what is the same-origin? In short, having the same protocol, IP/domain name, and port can be considered the same-origin. If any of these are different, it is not the same-origin. Some examples are given in the table below:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("URLs")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("Result")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("Reason")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("http://www.company.com/")]),s("br"),s("code",[t._v("https://www.company.com/")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Not the Same-Origin")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("The protocol is different")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("http://www.company.com/")]),s("br"),s("code",[t._v("http://www.company.net/")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Not the Same-Origin")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("The domain name is different")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("http://www.company.com/")]),s("br"),s("code",[t._v("http://blog.company.com/")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Not the Same-Origin")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("The domain name is different")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("http://www.company.com/")]),s("br"),s("code",[t._v("http://www.company.com:8080/")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Not the Same-Origin")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("The port is different (The default port for "),s("code",[t._v("http://")]),t._v(" is 80)")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("http://www.company.com/")]),s("br"),s("code",[t._v("http://www.company.com/blog.html")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Same-Origin")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Only the path is different")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("http://www.company.com/blog/index.html")]),s("br"),s("code",[t._v("http://www.company.com/blog.html")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Same-Origin")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Only the path is different")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("http://192.168.0.1/")]),s("br"),s("code",[t._v("http://192.168.1.1")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Not the Same-Origin")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("The IP address is different")])])])]),t._v(" "),s("h3",{attrs:{id:"two-kinds-of-cors-requests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#two-kinds-of-cors-requests"}},[t._v("#")]),t._v(" Two kinds of CORS Requests")]),t._v(" "),s("p",[t._v("Browsers divide CORS requests into two categories: simple requests and non-simple requests.")]),t._v(" "),s("p",[t._v("A request is a simple request as long as it meets the following two conditions simultaneously:")]),t._v(" "),s("ol",[s("li",[t._v("The request method is one of the three methods： "),s("code",[t._v("HEAD")]),t._v(", "),s("code",[t._v("GET")]),t._v(", "),s("code",[t._v("POST")]),t._v(".")]),t._v(" "),s("li",[t._v("The header information of HTTP does not exceed the following fields:\n"),s("ul",[s("li",[s("code",[t._v("Accept")])]),t._v(" "),s("li",[s("code",[t._v("Accept-Language")])]),t._v(" "),s("li",[s("code",[t._v("Content-Language")])]),t._v(" "),s("li",[s("code",[t._v("Last-Event-ID")])]),t._v(" "),s("li",[s("code",[t._v("Content-Type")]),t._v(" is one of the following: "),s("code",[t._v("application/x-www-form-urlencoded")]),t._v(", "),s("code",[t._v("multipart/form-data")]),t._v(", "),s("code",[t._v("text/plain")]),t._v(".")])])])]),t._v(" "),s("p",[t._v("Browsers handle these two kinds of requests differently.")]),t._v(" "),s("h4",{attrs:{id:"simple-requests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#simple-requests"}},[t._v("#")]),t._v(" Simple Requests")]),t._v(" "),s("p",[t._v("For simple requests, the browser directly sends a CORS request and adds an "),s("code",[t._v("Origin")]),t._v(" field in the request header.")]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/simple-request.png",alt:"simple-request"}})]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("Origin")]),t._v(" field indicates which origin (protocol, domain, port) the request comes from. The server can set the "),s("code",[t._v("Access-Control-Allow-Origin")]),t._v(" field based on this value to tell the browser whether to respond to this request.")]),t._v(" "),s("h4",{attrs:{id:"non-simple-requests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#non-simple-requests"}},[t._v("#")]),t._v(" Non-Simple Requests")]),t._v(" "),s("p",[t._v("Non-simple requests are different from simple requests. When the browser detects a non-simple request, it will automatically send an OPTIONS request first, which is called a preflight request. The purpose of the preflight request is to ask the server if cross-origin requests are allowed, which can avoid additional calculation logic.")]),t._v(" "),s("p",[t._v("After receiving the response from the preflight request, the browser will determine whether to continue sending the second request based on the related fields such as "),s("code",[t._v("Access-Control-Allow-Origin")]),t._v(" and "),s("code",[t._v("Access-Control-Allow-Methods")]),t._v(" in the response header.")]),t._v(" "),s("h3",{attrs:{id:"several-typical-cross-origin-errors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#several-typical-cross-origin-errors"}},[t._v("#")]),t._v(" Several Typical Cross-Origin Errors")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("The response header does not contain "),s("code",[t._v("Access-Control-Allow-Origin")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-log extra-class"},[s("pre",{pre:!0,attrs:{class:"language-log"}},[s("code",[t._v("Access to fetch at "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1:8967/1.pdf'")]),t._v(" from origin "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1:7001'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("has been blocked by CORS policy:")]),t._v("\nNo "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),t._v(" header is present on the requested resource"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" \nIf an opaque response serves your needs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" set the request's mode to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'no-cors'")]),t._v(" to fetch the resource with CORS disabled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("Access-Control-Allow-Origin")]),t._v(" format error：")]),t._v(" "),s("div",{staticClass:"language-log extra-class"},[s("pre",{pre:!0,attrs:{class:"language-log"}},[s("code",[t._v("Access to fetch at "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<The target origin of AJAX request: for example: http://192.168.0.1:8080>'")]),t._v(" from origin "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1:7001'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("has been blocked by CORS policy:")]),t._v("\nThe "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),t._v(" header contains the invalid value "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'192.168.0.1'")]),t._v(" for example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nHave the server send the header with a valid value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" or"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" if an opaque response serves your needs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \nset the request's mode to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'no-cors'")]),t._v(" to fetch the resource with CORS disabled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("p",[s("img",{attrs:{src:"/assets/invalid-access-origin.png",alt:"invalid access origin"}})])]),t._v(" "),s("li",[s("p",[s("code",[t._v("Access-Control-Allow-Origin")]),t._v(" does not match:")]),t._v(" "),s("div",{staticClass:"language-log extra-class"},[s("pre",{pre:!0,attrs:{class:"language-log"}},[s("code",[t._v("Access to fetch at "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1:8967/1.pdf'")]),t._v(" from origin "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1:7001'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("has been blocked by CORS policy:")]),t._v(" Response to preflight request doesn't pass access control check"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" The "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),t._v(" header has a value "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<Access-Control-Allow-Origin response header content, for example：http://127.0.0.1:9999>'")]),t._v(" that is not equal to the supplied origin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Have the server send the header with a valid value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" or"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" if an opaque response serves your needs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" set the request's mode to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'no-cors'")]),t._v(" to fetch the resource with CORS disabled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("Access-Control-Allow-Headers")]),t._v(" is not set:")]),t._v(" "),s("div",{staticClass:"language-log extra-class"},[s("pre",{pre:!0,attrs:{class:"language-log"}},[s("code",[t._v("Access to fetch at "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1:8967/1.pdf'")]),t._v(" from origin "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1:7001'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("has been blocked by CORS policy:")]),t._v(" Request header field range is not allowed by Access"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Control"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Allow"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Headers in preflight response\n")])])]),s("p",[s("img",{attrs:{src:"/assets/missing-allow-headers.png",alt:"missing-allow-headers"}})])])]),t._v(" "),s("h2",{attrs:{id:"cors-solutions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cors-solutions"}},[t._v("#")]),t._v(" CORS Solutions")]),t._v(" "),s("p",[t._v("There are two ways to solve CORS. One is to use a proxy server to avoid cross-origin issues, and the other is to configure CORS rules.")]),t._v(" "),s("h3",{attrs:{id:"using-a-proxy-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-a-proxy-server"}},[t._v("#")]),t._v(" Using a proxy server")]),t._v(" "),s("p",[t._v("A proxy server is an intermediary server between the client and target server, which can be used to request third-party URL resources. Since the request is initiated by the proxy server, the browser does not have CORS problems. We can set up a proxy server ourselves or use a third-party proxy server. Here we introduce the methods of configuring a proxy server using nginx and node.js. These two methods implement the same function, which is to proxy requests for "),s("code",[t._v("/prefix/*")]),t._v(" to the third-party server "),s("code",[t._v("http://third_party.file.server")]),t._v(", while removing the "),s("code",[t._v("/prefix")]),t._v(" prefix from the original path. For example, the URL "),s("code",[t._v("http://location:3000/prefix/path/to/some.pdf")]),t._v(" will be proxied to "),s("code",[t._v("http://third_party.file.server/path/to/some.pdf")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"configure-a-proxy-server-with-nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-a-proxy-server-with-nginx"}},[t._v("#")]),t._v(" Configure a proxy server with Nginx")]),t._v(" "),s("p",[t._v("Nginx is a high-performance web server that can be used as a proxy server. Following is the method of configuring a proxy server in Nginx.")]),t._v(" "),s("p",[t._v("Open the Nginx configuration file (usually located in "),s("code",[t._v("/etc/nginx/nginx.conf")]),t._v(", depending on the server environment), find the corresponding server block, and add the following code:")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~* ^/prefix/(.*)")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://third_party.file.server/"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$is_args")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$args")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_redirect")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("off")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("In the above code, Nginx first constructs the correct file URL path when receiving a request that starts with "),s("code",[t._v("/prefix")]),t._v(" in the path, and then proxies the request to the third-party file server.")]),t._v(" "),s("h4",{attrs:{id:"configure-a-proxy-server-with-node-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-a-proxy-server-with-node-js"}},[t._v("#")]),t._v(" Configure a proxy server with Node.js")]),t._v(" "),s("p",[t._v("Take Express, Koa, and NestJS as examples.")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Express")]),t._v(" "),s("p",[t._v("Express can use the third-party middleware "),s("code",[t._v("http-proxy-middleware")]),t._v(" to implement proxying, and with the routing functionality of Express, proxy requests starting with prefix to a third-party file server:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" createProxyMiddleware "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http-proxy-middleware'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/prefix'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createProxyMiddleware")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("target")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://third_party.file.server'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("changeOrigin")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("pathRewrite")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'^/prefix'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("This code will replace the "),s("code",[t._v("/prefix/")]),t._v(" in the path when receiving requests starting with "),s("code",[t._v("/prefix")]),t._v(", and forward the request to the target URL. For more usage, please refer to "),s("a",{attrs:{href:"https://www.npmjs.com/package/http-proxy-middleware",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.npmjs.com/package/http-proxy-middleware"),s("OutboundLink")],1),t._v(".")])]),t._v(" "),s("li",[s("p",[t._v("Koa")]),t._v(" "),s("p",[t._v("Koa needs to use the third-party middleware koa-proxy to implement proxying:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Koa "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'koa'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" proxy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'koa-proxy'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Koa")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("proxy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/prefix'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("host")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://third_party.file.server'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("match")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("^\\/prefix\\/")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/prefix'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Replace the /prefix prefix in the path")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("For more usage, please refer to "),s("a",{attrs:{href:"https://www.npmjs.com/package/koa-proxy",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.npmjs.com/package/koa-proxy"),s("OutboundLink")],1),t._v(".")])]),t._v(" "),s("li",[s("p",[t._v("NestJS")]),t._v(" "),s("p",[t._v("Similar to Express, NestJS can use the third-party middleware "),s("code",[t._v("http-proxy-middleware")]),t._v(" to implement proxying:")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" NestFactory "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@nestjs/core'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" AppModule "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./app.module'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" createProxyMiddleware "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http-proxy-middleware'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bootstrap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" NestFactory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AppModule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Proxy endpoints")]),t._v("\n    app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/prefix'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createProxyMiddleware")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        target"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://third_party.file.server'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        changeOrigin"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        pathRewrite"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("^/prefix")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bootstrap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("This code has the same effect as the example of Express.")])])]),t._v(" "),s("h3",{attrs:{id:"configuring-cors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuring-cors"}},[t._v("#")]),t._v(" Configuring CORS")]),t._v(" "),s("p",[t._v("In Foixt PDF SDK for Web, "),s("a",{attrs:{href:"https://developers.foxit.com/resources/pdf-sdk-web/api_reference/class_p_d_f_viewer.html#a851027c594370b047cac39b85fe1db44",target:"_blank",rel:"noopener noreferrer"}},[t._v("PDFViewer.openPDFByHttpRangeRequest"),s("OutboundLink")],1),t._v(" API often encounters cross-domain problems. In order to improve the speed of opening PDF documents and reduce file server bandwidth, this API will send a request with the "),s("code",[t._v("Range")]),t._v(" request header to the file server when requesting PDF files. After receiving the response, it needs to calculate the total file size based on the "),s("code",[t._v("Content-Range")]),t._v(" response header. Therefore, when configuring CORS, the following three items should be included at least.")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("Access-Control-Allow-Headers: Range"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nAccess-Control-Allow-Origin: *"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // For security reasons, it is recommended to be the same as the value of the Referer header "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" the request.\n\nAccess-Control-Expose-Headers: Content-Range"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // Only the response header keys added here can be obtained by JavaScript to get the values of the response headers. \n")])])]),s("p",[t._v("Below are the configuration methods for several different scenarios.")]),t._v(" "),s("h4",{attrs:{id:"configure-cors-with-web-servers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-cors-with-web-servers"}},[t._v("#")]),t._v(" Configure CORS with web servers")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Configure CORS with Nginx")]),t._v(" "),s("p",[t._v("Add the following node to the nginx.conf file (usually located at "),s("code",[t._v("/etc/nginx/nginx.conf")]),t._v("):")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8967")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" 127.0.0.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("charset")]),t._v(" utf8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/path/to/files/directory/"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ("),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_method")]),t._v(" = OPTIONS)")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Headers'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Range'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Expose-Headers'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Range'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("204")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Headers'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Range'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Expose-Headers'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Range'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("The above configuration allows all sites to access resources across domains, which is an unsafe but convenient approach. In actual application scenarios, restrictions should be added, such as setting whether to allow cross-domain access based on the origin of the request. The approach is as follows:")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Add the $cors variable and use $http_origin to determine if the origin is valid. The following code will allow all subdomains of foxit.com to access resources across domains:")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_origin")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$cors")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    '~*^https?://.*.foxit.com$' 'true'"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("Add the $allow_origin variable. If the value of $cors is 'true', it means that the request is a cross-domain request, and then response the value of "),s("code",[t._v("Access-Control-Allow-Origin")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$cors")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$allow_origin")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    'true' $http_origin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("Similarly, you can specify the "),s("code",[t._v("Access-Control-Allow-Headers")]),t._v(" response header when making a cross-domain request.")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$cors")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$allow_headers")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    'true' 'Range'"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("Finally, integrate all the configurations.")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_origin")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$cors")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    '~*^https?://.+.foxit.com$' 'true'"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$cors")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$allow_origin")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    'true' $http_origin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$cors")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$allow_headers")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    'true' 'Range'"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$cors")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$allow_expose_headers")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    'true' 'Content-Range'\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8967")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" 127.0.0.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("charset")]),t._v(" utf8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/path/to/files/directory/"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ("),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_method")]),t._v(" = OPTIONS)")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Headers'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$allow_headers")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$allow_origin")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Expose-Headers'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$allow_expose_headers")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("204")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Headers'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$allow_headers")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$allow_origin")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Expose-Headers'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$allow_expose_headers")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])]),t._v(" "),s("p",[t._v("In order to ensure that the modifications are correct, we recommend running "),s("code",[t._v("nginx -t")]),t._v(" to check if there are any errors in the modified configuration. If there are no errors, then run "),s("code",[t._v("nginx -s reload")]),t._v(" to reload the Nginx service.")])]),t._v(" "),s("li",[s("p",[t._v("Configure CORS with Tomcat")]),t._v(" "),s("p",[t._v("Following is a simple example of CORS configuration. You can also refer to the official documentation of Tomcat: "),s("a",{attrs:{href:"http://tomcat.apache.org/tomcat-7.0-doc/config/filter.html#CORS_Filter",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://tomcat.apache.org/tomcat-7.0-doc/config/filter.html#CORS_Filter"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("filter")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("filter-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("CorsFilter"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("filter-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("filter-class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.catalina.filters.CorsFilter"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("filter-class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("filter")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("init-param")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("param-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("cors.allowed.origins"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("param-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("param-value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("https://*.foxit.org"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("param-value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("init-param")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("init-param")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("param-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("cors.allowed.headers"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("param-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("param-value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Range"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("param-value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("init-param")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("init-param")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("param-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("cors.exposed.headers"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("param-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("param-value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Content-Range"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("param-value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("init-param")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("filter-mapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("filter-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("CorsFilter"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("filter-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("url-pattern")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("/*"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("url-pattern")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("filter-mapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("Configure CORS with Apache")]),t._v(" "),s("p",[t._v("In Apache, we can enable CORS by adding the following rules to the "),s("code",[t._v("<Directory>")]),t._v(", "),s("code",[t._v("<Location>")]),t._v(", "),s("code",[t._v("<Files>")]),t._v(" or "),s("code",[t._v("<VirtualHost>")]),t._v(" section in the server configuration, which is usually located in httpd.conf or apache.conf:")]),t._v(" "),s("div",{staticClass:"language-conf extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Header set Access-Control-Allow-Origin '*';\nHeader set Access-Control-Allow-Headers 'Range';\nHeader set Access-Control-Expose-Headers 'Content-Range';\n")])])]),s("p",[t._v("You can also add the following code to the .htaccess file:")]),t._v(" "),s("div",{staticClass:"language-conf extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("<IfModule mod_headers.c>\n    Header set Access-Control-Allow-Origin '*';\n    Header set Access-Control-Allow-Headers 'Range';\n    Header set Access-Control-Expose-Headers 'Content-Range';\n</IfModule>\n")])])]),s("p",[t._v("In order to ensure that the modifications are correct, we recommend running "),s("code",[t._v("apachectl -t")]),t._v(" to check if there are any errors in the modified configuration. If there are no errors, then run "),s("code",[t._v("sudo service apache2.conf")]),t._v(" or "),s("code",[t._v("apachectl -k graceful")]),t._v(" to reload the Apache service.")]),t._v(" "),s("p",[t._v("Note: You can also use the "),s("code",[t._v("add")]),t._v(" command instead of the "),s("code",[t._v("set")]),t._v(" command, but using "),s("code",[t._v("add")]),t._v(" may result in the header information being added multiple times. Therefore, the safest approach is to use "),s("code",[t._v("set")]),t._v(".")])]),t._v(" "),s("li",[s("p",[t._v("Configure CORS with IIS")]),t._v(" "),s("p",[t._v("The configuration methods for IIS6 and IIS7 versions are different. Please confirm the version you are currently using before configuring.")]),t._v(" "),s("ol",[s("li",[t._v("IIS6")])]),t._v(" "),s("p",[t._v("Open IIS, select the site you need to configure, and right-click to open the property dialog box. Select the 'HTTP Headers' tab, and click the 'Add' button, and then add these response headers: "),s("code",[t._v("Access-Control-Allow-Headers: 'Range'")]),t._v(", "),s("code",[t._v("Access-Control-Allow-Origin: *")]),t._v(", "),s("code",[t._v("Access-Control-Expose-Headers: Content-Range")]),t._v(".")]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("IIS7")])]),t._v(" "),s("p",[t._v("Please merge or add the following configuration to your site configuration file (i.e. web.config file. If you do not have this file, you can create a new one.):")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v('<?xml version="1.0" encoding="utf-8"?>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("system.webServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("httpProtocol")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("customHeaders")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("add")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Access-Control-Allow-Origin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("*"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("add")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Access-Control-Allow-Headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Range"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("add")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Access-Control-Expose-Headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Content-Range"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("customHeaders")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("httpProtocol")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("system.webServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])])]),t._v(" "),s("h4",{attrs:{id:"configure-cors-with-cloud-storage-resources"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-cors-with-cloud-storage-resources"}},[t._v("#")]),t._v(" Configure CORS with cloud storage resources")]),t._v(" "),s("p",[t._v("There are many cloud storage and CDN services in the market, and most of them have their corresponding configuration methods available in their official documentation. Here are just a few examples:")]),t._v(" "),s("ol",[s("li",[t._v("Alibaba Cloud: "),s("a",{attrs:{href:"https://www.alibabacloud.com/help/en/object-storage-service/latest/configure-cors",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.alibabacloud.com/help/en/object-storage-service/latest/configure-cors"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("Tencent Cloud: "),s("a",{attrs:{href:"https://www.tencentcloud.com/document/product/436/13318",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.tencentcloud.com/document/product/436/13318"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("Google Cloud: "),s("a",{attrs:{href:"https://cloud.google.com/storage/docs/using-cors",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cloud.google.com/storage/docs/using-cors"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("Azure Storage: "),s("a",{attrs:{href:"https://learn.microsoft.com/en-us/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://learn.microsoft.com/en-us/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("AWS S3: "),s("a",{attrs:{href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/cors.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.aws.amazon.com/AmazonS3/latest/userguide/cors.html"),s("OutboundLink")],1)])]),t._v(" "),s("h4",{attrs:{id:"configure-cors-in-server-side-frameworks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-cors-in-server-side-frameworks"}},[t._v("#")]),t._v(" Configure CORS in server-side frameworks")]),t._v(" "),s("ol",[s("li",[t._v("Node.js related frameworks\n"),s("ol",[s("li",[t._v("Express: please refer to "),s("a",{attrs:{href:"https://expressjs.com/en/resources/middleware/cors.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("express cors middleware"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("Koa: please refer to "),s("a",{attrs:{href:"https://github.com/koajs/cors",target:"_blank",rel:"noopener noreferrer"}},[t._v("@koa/cors"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("NestJS: please refer to "),s("a",{attrs:{href:"https://docs.nestjs.com/security/cors",target:"_blank",rel:"noopener noreferrer"}},[t._v("CORS|NestJS"),s("OutboundLink")],1)])])]),t._v(" "),s("li",[t._v("SpringBoot (java) framework：please refer to "),s("a",{attrs:{href:"https://spring.io/guides/gs/rest-service-cors/#_enabling_cors",target:"_blank",rel:"noopener noreferrer"}},[t._v("Enabling Cross Origin Requests for a RESTful Web Service"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("Django (python) framework：please refer to "),s("a",{attrs:{href:"https://pypi.org/project/django-cors-headers/",target:"_blank",rel:"noopener noreferrer"}},[t._v("django-cors-headers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("Laravel (php) framework：please refer to "),s("a",{attrs:{href:"https://github.com/fruitcake/laravel-cors",target:"_blank",rel:"noopener noreferrer"}},[t._v("laravel-cors"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);